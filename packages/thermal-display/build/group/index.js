(()=>{"use strict";var e,s={41:()=>{const e=window.wp.blocks,s=window.wp.i18n,t=window.wp.element,l=window.wp.blockEditor,a=window.wp.components,i="labir_embed_lib_dynamical",n=window.location.origin,o=e=>{const s=e.createElement("script");return s.type="module",s.id=i,s.innerHTML=`import '${n}/wp-content/plugins/thermal-display/assets/embed.esm.js'`,s},r=e=>!!e.getElementById(i),c=window.ReactJSXRuntime,d=({thermal:e,open:s,setOpen:l,attributes:i,setAttributes:n})=>{const o=(0,t.useMemo)((()=>(1e6*Math.random()).toFixed(0)),[]),r=(0,t.useCallback)((e=>`${o}__${e}`),[o]),{palette:d,from:h,to:p,analysis1:u,analysis2:m,analysis3:y,analysis4:x,analysis5:f,analysis6:v,analysis7:j}=i,b=(0,t.useCallback)((e=>{if(e){const s=e=>{e.slots.onSlot1Serialize.set(o,(e=>n({analysis1:e}))),e.slots.onSlot2Serialize.set(o,(e=>n({analysis2:e}))),e.slots.onSlot3Serialize.set(o,(e=>n({analysis3:e}))),e.slots.onSlot4Serialize.set(o,(e=>n({analysis4:e}))),e.slots.onSlot5Serialize.set(o,(e=>n({analysis5:e}))),e.slots.onSlot6Serialize.set(o,(e=>n({analysis6:e}))),e.slots.onSlot7Serialize.set(o,(e=>n({analysis7:e})))};e.onInstanceCreated.set(r("instance_created__2"),s)}}),[e]);return s?(0,c.jsx)(a.Modal,{title:"Analysis editor",isFullScreen:!0,onRequestClose:()=>l(!1),children:(0,c.jsx)("manager-provider",{slug:r("manager"),palette:d,children:(0,c.jsx)("registry-provider",{from:h,to:p,children:(0,c.jsx)("group-provider",{children:(0,c.jsxs)("file-provider",{thermal:e,ref:b,analysis1:u,analysis2:m,analysis3:y,analysis4:x,analysis5:f,analysis6:v,analysis7:j,children:[(0,c.jsxs)("div",{className:"modal-editor__container",children:[(0,c.jsxs)("div",{className:"modal-editor__canvas",children:[(0,c.jsx)("file-canvas",{}),(0,c.jsx)("div",{children:(0,c.jsx)("file-timeline",{})})]}),(0,c.jsxs)("div",{className:"modal-editor__details",children:[(0,c.jsx)("p",{children:"Use the tools to draw analyses on the image!"}),(0,c.jsx)("group-tool-buttons",{style:{paddingBottom:"1rem"}}),(0,c.jsx)("div",{style:{},children:(0,c.jsx)("file-analysis-table",{})}),(0,c.jsx)("div",{style:{height:300},children:(0,c.jsx)("file-analysis-graph",{style:{height:"300px"}})})]})]}),(0,c.jsx)("div",{style:{width:"100%",paddingTop:"1rem"},children:(0,c.jsx)(a.Button,{size:"compact",variant:"primary",style:{},onClick:()=>l(!1),children:"Close"})})]})})})})}):(0,c.jsx)(c.Fragment,{})},h=(e,s)=>`${e}~${s}`,p=(e,s)=>e.split(s).map((e=>e.trim())),u=e=>{const s=p(e,";").map((e=>{const s=p(e,"|").map((e=>{const[s,t]=p(e,"~");return[s,t]}));return s})).map((e=>Object.fromEntries(e)));return Object.fromEntries(s.map((e=>[e.thermal,e])))},m=JSON.parse('{"UU":"thermal-display/group"}');(()=>{const e=o(document);document.head.appendChild(e)})(),(0,e.registerBlockType)(m.UU,{edit:function({attributes:e,setAttributes:i}){const n=(0,t.useMemo)((()=>Math.random().toString()));(0,t.useEffect)((()=>{const e=document.querySelectorAll("iframe");for(let s=0;s<e.length;s++){const t=e[s];if("editor-canvas"===t.name){const e=t.contentWindow.document;if(!r(e)){const s=o(e);e.head.appendChild(s)}}}}),[]);const{webcomponent:p,palette:m,thermal:y,files:x,opacity:f,visible:v,label:j,description:b,author:g,license:w,from:k,to:C,analysis1:_,analysis2:S,analysis3:O,analysis4:M,analysis5:B,analysis6:N,analysis7:E,speed:U,showabout:T,showhistogram:L,interactiveanalysis:F,preservetime:z}=e,A=(e=>{const s=(0,t.useMemo)((()=>e),[]),l=(0,t.useMemo)((()=>void 0===e?{}:u(e)),[]),[a,i]=(0,t.useState)(l),[n,o]=(0,t.useState)(s);(0,t.useEffect)((()=>{s&&i(u(s))}),[s]),(0,t.useEffect)((()=>{if("object"==typeof a){let e="";const s=[];Object.entries(a).forEach((([e,t])=>{const l=Object.keys(t);if(l.includes("thermal")){const e=[h("thermal",t.thermal)];l.includes("visible")&&e.push("visible",h("visible",t.visible)),l.includes("note")&&e.push("note",h("note",t.note)),l.includes("label")&&e.push(h("label",t.label));const a=(e=>e.join("|"))(e);s.push(a)}})),e=s.join(";"),e.length>0?o(e):o(void 0)}else o(void 0)}),[a]);const r=(0,t.useCallback)(((e,s,t,l)=>{Object.keys(a).includes(e)?(a[e]={...a[e],visible:s,label:t,note:l},i({...a})):e.length>0&&e&&(a[e]={visible:s,thermal:e,label:t,note:l},i({...a}))}),[i,a]),c=(0,t.useCallback)((e=>{if(Object.keys(a).includes(e)){const{[e]:s,...t}=a;i(t)}}),[i,a]),d=(0,t.useCallback)((e=>{const s={...a},t=Object.keys(s);e.forEach((e=>{t.includes(e)||(console.log("added",e),s[e]={thermal:e})})),t.forEach((t=>{e.includes(t)||(console.log("removing",t),delete s[t])})),i(s)}),[a,i]),p=(0,t.useCallback)(((e,s)=>{if(Object.keys(a).includes(e)){const t={...a},l={...t[e],thermal:s};delete t[e],t[s]=l,i(t)}}),[a,i]),m=(0,t.useCallback)(((e,s)=>{if(console.log(e,s),Object.keys(a).includes(e)){const t={...a};t[e].label=s,i(t)}}),[a,i]),y=(0,t.useCallback)(((e,s)=>{if(Object.keys(a).includes(e)){const t={...a};t[e]=s,i(t)}}),[a,i]);return{files:a,parsed:n,addFile:r,removeFile:c,syncUrls:d,updateFileLabel:m,updateFileUrl:p,updateFileNote:y}})(x);(0,t.useEffect)((()=>{A.parsed!==x&&i({files:A.parsed})}),[A.parsed]);const[I,P]=(0,t.useState)(y),[R,$]=(0,t.useState)(),{open:H,setOpen:Z}=(()=>{const[e,s]=(0,t.useState)(!1);return{open:e,setOpen:s}})(),D=()=>{P(y),i({thermal:y})},V=((0,t.useCallback)((e=>{console.log("displaysettingcallback",e,e.registry),e&&e.registry.range.addListener(n,(e=>{i(e instanceof Object?e:{from:void 0,to:void 0})}))}),[]),(0,t.useRef)()),[q,J]=(0,t.useState)();return(0,t.useEffect)((()=>{console.log(">>>",V.current),void 0===q&&(setTimeout((()=>{if(null!==V.current){const e=V.current.group;e.registry.palette.addListener(n,(e=>{i({palette:e})})),e.registry.range.addListener(n,(e=>{e&&i(e)})),e.analysisSync.onSlotSync.set(n,((e,s)=>{const t=`analysis${s}`;console.log(t,e),i({[t]:e})})),V.current.onColumns.set(n,(e=>{i({columns:e})})),J(V.current.group)}}),0),console.log("==========",V.current))}),[V.current,q,J,i]),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(l.MediaUploadCheck,{children:(0,c.jsxs)(l.InspectorControls,{children:[(0,c.jsxs)(a.PanelBody,{title:"Thermal files",children:[(0,c.jsx)(d,{thermal:y,open:H,setOpen:Z,attributes:e,setAttributes:i}),(0,c.jsxs)("div",{style:{marginBottom:"1rem",marginTop:y?"1rem":"0"},children:[(0,c.jsx)(l.MediaUpload,{allowedTypes:["application/octet-stream"],multiple:!0,onSelect:e=>{if(console.log(">>>>>",e),Array.isArray(e)){const s=e.map((e=>e.url));A.syncUrls(s)}},render:({open:e})=>(0,c.jsx)(a.Button,{onClick:()=>{D(),e()},variant:"primary",children:"Upload or select a LRC files"})}),Object.values(A.files).map((e=>{let s=e.label?e.label:e.thermal.match(/[^/]*$/)[0];return(0,c.jsx)(a.Panel,{children:(0,c.jsxs)(a.PanelBody,{title:s,initialOpen:!1,children:[(0,c.jsx)(a.TextControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,onChange:s=>{A.updateFileLabel(e.thermal,s)},value:e.label,label:"Label"}),(0,c.jsx)(a.Button,{variant:"primary",isDestructive:!0,size:"small",onClick:()=>A.removeFile(e.thermal),children:"Remove"})]})})}))]})]}),(0,c.jsxs)(a.PanelBody,{title:"Information",initialOpen:!1,children:[(0,c.jsx)(a.TextControl,{label:(0,s.__)("Author","thermal-display"),value:g||"",onChange:e=>i({author:e})}),(0,c.jsx)(a.TextControl,{label:(0,s.__)("License","thermal-display"),value:w||"",onChange:e=>i({license:e})}),(0,c.jsx)(a.TextControl,{label:(0,s.__)("Label","thermal-display"),help:"Label appears on the black button on top & left of the app.",value:j||"",onChange:e=>i({label:e})})]}),(0,c.jsxs)(a.PanelBody,{title:"Display settings",children:[(0,c.jsx)(a.CheckboxControl,{__nextHasNoMarginBottom:!0,checked:L,label:"Show histogram",hint:"Enable histogram display in the thermal scale?",onChange:e=>{i({showhistogram:e})}}),(0,c.jsx)(a.CheckboxControl,{__nextHasNoMarginBottom:!0,checked:T,label:"Show about button",help:"Display the button with application info?",onChange:e=>{i({showabout:e})}}),(0,c.jsx)(a.CheckboxControl,{__nextHasNoMarginBottom:!0,checked:F,label:"Interactive analysis",help:"Should the visitor be able to edit analysis?",onChange:e=>{i({interactiveanalysis:e})}}),(0,c.jsx)(a.CheckboxControl,{__nextHasNoMarginBottom:!0,checked:z,label:"Preserve time in file labels",help:"Should the file time be displayed even if the file has a custom label?",onChange:e=>{i({preservetime:e})}})]})]})}),(0,c.jsx)("div",{...(0,l.useBlockProps)(),children:void 0!==A.parsed?(0,c.jsx)(a.Tooltip,{text:"Click on to edit",delay:300,hideOnClick:!1,children:(0,c.jsx)("thermal-group-app",{files:A.parsed,label:j,author:g,license:w,palette:m,ref:V,analysis1:_,analysis2:S,analysis3:O,analysis4:M,analysis5:B,analysis6:N,analysis7:E,showabout:T,showhistogram:L,interactiveanalysis:F,preservetime:z})}):(0,c.jsx)(a.Placeholder,{label:"Thermal group",instructions:"Display multiple IR recordings taken by IR camera TIMI Edu.",icon:(0,c.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",viewBox:"0 0 512 512",children:(0,c.jsx)("g",{children:(0,c.jsxs)("g",{id:"Vrstva_1",children:[(0,c.jsx)("path",{d:"M327.6,240c-5.4-4.7-13.6-7.1-24.6-7.1h-51.9v60.8h52c10.9,0,19-2.4,24.6-7.2s8.2-12.7,8.2-23.6-2.8-18.1-8.3-22.8Z"}),(0,c.jsx)("path",{d:"M252.4,0L18.9,90.7h-.6v421.3h466.9V90.7h.6L252.4,0ZM161.8,411.9h-47.5v-216h47.5v216ZM342.1,411.9c-2.8-7.9-4.5-16.2-4.9-24.6-.6-9.5-1.5-18.4-2.7-27.2-1.6-11.3-5-19.5-10.3-24.8s-13.8-7.9-25.7-7.9h-47.5v84.4h-47.5v-215.9h116.4c8.9-.1,17.8,1.5,26.2,4.7,7.4,2.9,14.2,7.3,19.9,12.8,5.5,5.4,9.8,11.8,12.7,18.9,3,7.3,4.5,15.2,4.4,23.1.3,11.5-2.4,22.9-7.9,33-6,9.9-15.3,17.3-26.2,21.2v.6c5.3,1.3,10.3,3.9,14.5,7.4,3.8,3.3,7,7.3,9.4,11.8,2.5,4.7,4.3,9.7,5.3,15,1.1,5.4,1.9,10.9,2.3,16.3.2,3.4.4,7.5.6,12.1s.6,9.2,1.1,14.2c.5,4.6,1.3,9.2,2.4,13.7.9,4,2.6,7.7,5,11.1h-47.6Z"})]})})}),children:(0,c.jsx)(l.MediaUpload,{allowedTypes:["application/octet-stream"],multiple:!0,onSelect:e=>{if(Array.isArray(e)){const s=e.map((e=>e.url));A.syncUrls(s)}},render:({open:e})=>(0,c.jsx)(a.Button,{onClick:()=>{D(),e()},variant:"primary",children:y?"Change file":"Upload or select a LRC file"})})})})]})},icon:{src:(0,c.jsxs)("svg",{id:"Vrstva_1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:[(0,c.jsx)("defs",{children:(0,c.jsxs)("linearGradient",{id:"Nepojmenovaný_přechod_12","data-name":"Nepojmenovaný přechod 12",x1:"284.42",y1:"36.32",x2:"4.77",y2:"252.5",gradientUnits:"userSpaceOnUse",children:[(0,c.jsx)("stop",{offset:"0","stop-color":"#eae200"}),(0,c.jsx)("stop",{offset:".34","stop-color":"#d42900"}),(0,c.jsx)("stop",{offset:"1","stop-color":"#0007bf"})]})}),(0,c.jsx)("rect",{x:"1",width:"511",height:"406.08",rx:"19.65",ry:"19.65"}),(0,c.jsx)("rect",{x:"25",y:"80.12",width:"219.72",height:"143.62",rx:"7.86",ry:"7.86",fill:"url(#Nepojmenovaný_přechod_12)"}),(0,c.jsx)("rect",{x:"262.54",y:"80.12",width:"219.72",height:"143.62",rx:"7.86",ry:"7.86",fill:"url(#Nepojmenovaný_přechod_12)"}),(0,c.jsx)("rect",{x:"25",y:"238",width:"219.72",height:"143.62",rx:"7.86",ry:"7.86",fill:"url(#Nepojmenovaný_přechod_12)"}),(0,c.jsx)("rect",{x:"262.54",y:"238",width:"219.72",height:"143.62",rx:"7.86",ry:"7.86",fill:"url(#Nepojmenovaný_přechod_12)"}),(0,c.jsx)("line",{x1:"31.36",y1:"30",x2:"100.3",y2:"30",fill:"none",stroke:"#818080","stroke-linecap":"round","stroke-miterlimit":"10","stroke-width":"11.89"}),(0,c.jsxs)("g",{children:[(0,c.jsx)("path",{d:"M481.05,512v-171.78s.02-.09.03-.13c1.15-6.15-2.24-12.25-8.07-14.51l-96.57-37.53c-1.51-.59-3.11-.88-4.71-.88h0c-1.6,0-3.19.29-4.71.88l-95.38,37.05c-5.62,1.44-9.77,6.53-9.77,12.6v174.31h219.17Z",fill:"#fff"}),(0,c.jsx)("polyline",{points:"371.74 300.17 468.3 337.69 468.05 337.69 468.05 512 274.88 512 274.88 337.69 275.13 337.69 371.74 300.17"}),(0,c.jsx)("path",{d:"M351.14,468.3h23.02v-40.9h23.02c5.77,0,9.89,1.26,12.45,3.83,2.57,2.57,4.22,6.54,4.99,12.02.58,4.26,1.02,8.58,1.31,13.18.19,4.05,1.01,8.06,2.36,11.87h-.03l.05.05s-.01-.03-.02-.05h23.03c-1.16-1.65-1.99-3.44-2.42-5.38-.53-2.18-.92-4.41-1.16-6.64-.24-2.42-.44-4.65-.53-6.88s-.19-4.22-.29-5.86c-.19-2.62-.58-5.28-1.11-7.9-.48-2.57-1.36-4.99-2.57-7.27-1.16-2.18-2.71-4.12-4.55-5.72-2.04-1.7-4.46-2.96-7.03-3.59v-.29c5.28-1.89,9.79-5.48,12.7-10.27,2.67-4.89,3.97-10.42,3.83-15.99.05-3.83-.68-7.66-2.13-11.19-1.41-3.44-3.49-6.54-6.15-9.16-2.76-2.67-6.06-4.8-9.64-6.2-3.95-1.51-8.13-2.28-12.31-2.28-.13,0-.25,0-.38,0h-56.4v104.62",fill:"#fff"}),(0,c.jsx)("polyline",{points:"307.91 468.35 330.93 468.35 330.93 363.69 307.91 363.69 307.91 468.35",fill:"#fff"}),(0,c.jsxs)("g",{children:[(0,c.jsx)("path",{d:"M411.27,385.05c-2.62-2.28-6.59-3.44-11.92-3.44h-25.15v29.46h25.2c5.28,0,9.21-1.16,11.92-3.49,2.71-2.33,3.97-6.15,3.97-11.44s-1.36-8.77-4.02-11.05v-.05Z"}),(0,c.jsx)("path",{d:"M399.35,381.61c5.33,0,9.3,1.16,11.92,3.44v.05c2.67,2.28,4.02,5.77,4.02,11.05s-1.26,9.11-3.97,11.44c-2.71,2.33-6.64,3.49-11.92,3.49h-25.2v-29.46h25.15"})]})]}),(0,c.jsx)("line",{x1:"31.36",y1:"59.57",x2:"481.52",y2:"59.57",fill:"none",stroke:"url(#Nepojmenovaný_přechod_12)","stroke-linecap":"round","stroke-miterlimit":"10","stroke-width":"11.89"})]})}})}},t={};function l(e){var a=t[e];if(void 0!==a)return a.exports;var i=t[e]={exports:{}};return s[e](i,i.exports,l),i.exports}l.m=s,e=[],l.O=(s,t,a,i)=>{if(!t){var n=1/0;for(d=0;d<e.length;d++){t=e[d][0],a=e[d][1],i=e[d][2];for(var o=!0,r=0;r<t.length;r++)(!1&i||n>=i)&&Object.keys(l.O).every((e=>l.O[e](t[r])))?t.splice(r--,1):(o=!1,i<n&&(n=i));if(o){e.splice(d--,1);var c=a();void 0!==c&&(s=c)}}return s}i=i||0;for(var d=e.length;d>0&&e[d-1][2]>i;d--)e[d]=e[d-1];e[d]=[t,a,i]},l.o=(e,s)=>Object.prototype.hasOwnProperty.call(e,s),(()=>{var e={557:0,985:0};l.O.j=s=>0===e[s];var s=(s,t)=>{var a,i,n=t[0],o=t[1],r=t[2],c=0;if(n.some((s=>0!==e[s]))){for(a in o)l.o(o,a)&&(l.m[a]=o[a]);if(r)var d=r(l)}for(s&&s(t);c<n.length;c++)i=n[c],l.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return l.O(d)},t=self.webpackChunkthermal_display=self.webpackChunkthermal_display||[];t.forEach(s.bind(null,0)),t.push=s.bind(null,t.push.bind(t))})();var a=l.O(void 0,[985],(()=>l(41)));a=l.O(a)})();