(()=>{"use strict";var e,s={41:()=>{const e=window.wp.blocks,s=window.wp.i18n,t=window.wp.element,l=window.wp.blockEditor,a=window.wp.components,n="labir_embed_lib_dynamical",i=window.location.origin,o=e=>{const s=e.createElement("script");return s.type="module",s.id=n,s.innerHTML=`import '${i}/wp-content/plugins/thermal-display/assets/embed.esm.js'`,s},r=e=>!!e.getElementById(n),c=window.ReactJSXRuntime,d=({thermal:e,open:s,setOpen:l,attributes:n,setAttributes:i})=>{const o=(0,t.useMemo)((()=>(1e6*Math.random()).toFixed(0)),[]),r=(0,t.useCallback)((e=>`${o}__${e}`),[o]),{palette:d,from:h,to:p,analysis1:u,analysis2:m,analysis3:y,analysis4:b,analysis5:v,analysis6:x,analysis7:g}=n,f=(0,t.useCallback)((e=>{if(e){const s=e=>{e.slots.onSlot1Serialize.set(o,(e=>i({analysis1:e}))),e.slots.onSlot2Serialize.set(o,(e=>i({analysis2:e}))),e.slots.onSlot3Serialize.set(o,(e=>i({analysis3:e}))),e.slots.onSlot4Serialize.set(o,(e=>i({analysis4:e}))),e.slots.onSlot5Serialize.set(o,(e=>i({analysis5:e}))),e.slots.onSlot6Serialize.set(o,(e=>i({analysis6:e}))),e.slots.onSlot7Serialize.set(o,(e=>i({analysis7:e})))};e.onInstanceCreated.set(r("instance_created__2"),s)}}),[e]);return s?(0,c.jsx)(a.Modal,{title:"Analysis editor",isFullScreen:!0,onRequestClose:()=>l(!1),children:(0,c.jsx)("manager-provider",{slug:r("manager"),palette:d,children:(0,c.jsx)("registry-provider",{from:h,to:p,children:(0,c.jsx)("group-provider",{children:(0,c.jsxs)("file-provider",{thermal:e,ref:f,analysis1:u,analysis2:m,analysis3:y,analysis4:b,analysis5:v,analysis6:x,analysis7:g,children:[(0,c.jsxs)("div",{className:"modal-editor__container",children:[(0,c.jsxs)("div",{className:"modal-editor__canvas",children:[(0,c.jsx)("file-canvas",{}),(0,c.jsx)("div",{children:(0,c.jsx)("file-timeline",{})})]}),(0,c.jsxs)("div",{className:"modal-editor__details",children:[(0,c.jsx)("p",{children:"Use the tools to draw analyses on the image!"}),(0,c.jsx)("group-tool-buttons",{style:{paddingBottom:"1rem"}}),(0,c.jsx)("div",{style:{},children:(0,c.jsx)("file-analysis-table",{})}),(0,c.jsx)("div",{style:{height:300},children:(0,c.jsx)("file-analysis-graph",{style:{height:"300px"}})})]})]}),(0,c.jsx)("div",{style:{width:"100%",paddingTop:"1rem"},children:(0,c.jsx)(a.Button,{size:"compact",variant:"primary",style:{},onClick:()=>l(!1),children:"Close"})})]})})})})}):(0,c.jsx)(c.Fragment,{})},h=(e,s)=>`${e}~${s}`,p=(e,s)=>e.split(s).map((e=>e.trim())),u=e=>{const s=p(e,";").map((e=>{const s=p(e,"|").map((e=>{const[s,t]=p(e,"~");return[s,t]}));return s})).map((e=>Object.fromEntries(e)));return Object.fromEntries(s.map((e=>[e.thermal,e])))},m=JSON.parse('{"UU":"thermal-display/group"}');(()=>{const e=o(document);document.head.appendChild(e)})(),(0,e.registerBlockType)(m.UU,{edit:function({attributes:e,setAttributes:n}){const i=(0,t.useMemo)((()=>Math.random().toString()));(0,t.useEffect)((()=>{const e=document.querySelectorAll("iframe");for(let s=0;s<e.length;s++){const t=e[s];if("editor-canvas"===t.name){const e=t.contentWindow.document;if(!r(e)){const s=o(e);e.head.appendChild(s)}}}}),[]);const{webcomponent:p,palette:m,thermal:y,files:b,opacity:v,visible:x,label:g,description:f,author:j,license:w,from:C,to:k,analysis1:_,analysis2:S,analysis3:O,analysis4:M,analysis5:B,analysis6:L,analysis7:E,speed:T,showabout:U,showhistogram:F,interactiveanalysis:z,preservetime:A}=e,N=(e=>{const s=(0,t.useMemo)((()=>e),[]),l=(0,t.useMemo)((()=>void 0===e?{}:u(e)),[]),[a,n]=(0,t.useState)(l),[i,o]=(0,t.useState)(s);(0,t.useEffect)((()=>{s&&n(u(s))}),[s]),(0,t.useEffect)((()=>{if("object"==typeof a){let e="";const s=[];Object.entries(a).forEach((([e,t])=>{const l=Object.keys(t);if(l.includes("thermal")){const e=[h("thermal",t.thermal)];l.includes("visible")&&e.push("visible",h("visible",t.visible)),l.includes("note")&&e.push("note",h("note",t.note)),l.includes("label")&&e.push(h("label",t.label));const a=(e=>e.join("|"))(e);s.push(a)}})),e=s.join(";"),e.length>0?o(e):o(void 0)}else o(void 0)}),[a]);const r=(0,t.useCallback)(((e,s,t,l)=>{Object.keys(a).includes(e)?(a[e]={...a[e],visible:s,label:t,note:l},n({...a})):e.length>0&&e&&(a[e]={visible:s,thermal:e,label:t,note:l},n({...a}))}),[n,a]),c=(0,t.useCallback)((e=>{if(Object.keys(a).includes(e)){const{[e]:s,...t}=a;n(t)}}),[n,a]),d=(0,t.useCallback)((e=>{const s={...a},t=Object.keys(s);e.forEach((e=>{t.includes(e)||(console.log("added",e),s[e]={thermal:e})})),t.forEach((t=>{e.includes(t)||(console.log("removing",t),delete s[t])})),n(s)}),[a,n]),p=(0,t.useCallback)(((e,s)=>{if(Object.keys(a).includes(e)){const t={...a},l={...t[e],thermal:s};delete t[e],t[s]=l,n(t)}}),[a,n]),m=(0,t.useCallback)(((e,s)=>{if(console.log(e,s),Object.keys(a).includes(e)){const t={...a};t[e].label=s,n(t)}}),[a,n]),y=(0,t.useCallback)(((e,s)=>{if(Object.keys(a).includes(e)){const t={...a};t[e]=s,n(t)}}),[a,n]);return{files:a,parsed:i,addFile:r,removeFile:c,syncUrls:d,updateFileLabel:m,updateFileUrl:p,updateFileNote:y}})(b);(0,t.useEffect)((()=>{N.parsed!==b&&n({files:N.parsed})}),[N.parsed]);const[I,P]=(0,t.useState)(y),[R,Z]=(0,t.useState)(),{open:$,setOpen:H}=(()=>{const[e,s]=(0,t.useState)(!1);return{open:e,setOpen:s}})(),D=()=>{P(y),n({thermal:y})},V=((0,t.useCallback)((e=>{console.log("displaysettingcallback",e,e.registry),e&&e.registry.range.addListener(i,(e=>{n(e instanceof Object?e:{from:void 0,to:void 0})}))}),[]),(0,t.useRef)()),[q,J]=(0,t.useState)();return(0,t.useEffect)((()=>{console.log(">>>",V.current),void 0===q&&(setTimeout((()=>{if(null!==V.current){const e=V.current.group;e.registry.palette.addListener(i,(e=>{n({palette:e})})),e.registry.range.addListener(i,(e=>{e&&n(e)})),e.analysisSync.onSlotSync.set(i,((e,s)=>{const t=`analysis${s}`;console.log(t,e),n({[t]:e})})),V.current.onColumns.set(i,(e=>{n({columns:e})})),J(V.current.group)}}),0),console.log("==========",V.current))}),[V.current,q,J,n]),(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(l.MediaUploadCheck,{children:(0,c.jsxs)(l.InspectorControls,{children:[(0,c.jsxs)(a.PanelBody,{title:"Thermal files",children:[(0,c.jsx)(d,{thermal:y,open:$,setOpen:H,attributes:e,setAttributes:n}),(0,c.jsxs)("div",{style:{marginBottom:"1rem",marginTop:y?"1rem":"0"},children:[(0,c.jsx)(l.MediaUpload,{allowedTypes:["application/octet-stream"],multiple:!0,onSelect:e=>{if(console.log(">>>>>",e),Array.isArray(e)){const s=e.map((e=>e.url));N.syncUrls(s)}},render:({open:e})=>(0,c.jsx)(a.Button,{onClick:()=>{D(),e()},variant:"primary",children:"Upload or select a LRC files"})}),Object.values(N.files).map((e=>{let s=e.label?e.label:e.thermal.match(/[^/]*$/)[0];return(0,c.jsx)(a.Panel,{children:(0,c.jsxs)(a.PanelBody,{title:s,initialOpen:!1,children:[(0,c.jsx)(a.TextControl,{__next40pxDefaultSize:!0,__nextHasNoMarginBottom:!0,onChange:s=>{N.updateFileLabel(e.thermal,s)},value:e.label,label:"Label"}),(0,c.jsx)(a.Button,{variant:"primary",isDestructive:!0,size:"small",onClick:()=>N.removeFile(e.thermal),children:"Remove"})]})})}))]})]}),(0,c.jsxs)(a.PanelBody,{title:"Information",initialOpen:!1,children:[(0,c.jsx)(a.TextControl,{label:(0,s.__)("Author","thermal-display"),value:j||"",onChange:e=>n({author:e})}),(0,c.jsx)(a.TextControl,{label:(0,s.__)("License","thermal-display"),value:w||"",onChange:e=>n({license:e})}),(0,c.jsx)(a.TextControl,{label:(0,s.__)("Label","thermal-display"),help:"Label appears on the black button on top & left of the app.",value:g||"",onChange:e=>n({label:e})})]}),(0,c.jsxs)(a.PanelBody,{title:"Display settings",children:[(0,c.jsx)(a.CheckboxControl,{__nextHasNoMarginBottom:!0,checked:F,label:"Show histogram",hint:"Enable histogram display in the thermal scale?",onChange:e=>{n({showhistogram:e})}}),(0,c.jsx)(a.CheckboxControl,{__nextHasNoMarginBottom:!0,checked:U,label:"Show about button",help:"Display the button with application info?",onChange:e=>{n({showabout:e})}}),(0,c.jsx)(a.CheckboxControl,{__nextHasNoMarginBottom:!0,checked:z,label:"Interactive analysis",help:"Should the visitor be able to edit analysis?",onChange:e=>{n({interactiveanalysis:e})}}),(0,c.jsx)(a.CheckboxControl,{__nextHasNoMarginBottom:!0,checked:A,label:"Preserve time in file labels",help:"Should the file time be displayed even if the file has a custom label?",onChange:e=>{n({preservetime:e})}})]})]})}),(0,c.jsx)("div",{...(0,l.useBlockProps)(),children:void 0!==N.parsed?(0,c.jsx)(a.Tooltip,{text:"Click on to edit",delay:300,hideOnClick:!1,children:(0,c.jsx)("thermal-group-app",{files:N.parsed,label:g,author:j,license:w,palette:m,ref:V,analysis1:_,analysis2:S,analysis3:O,analysis4:M,analysis5:B,analysis6:L,analysis7:E,showabout:U,showhistogram:F,interactiveanalysis:z,preservetime:A})}):(0,c.jsx)(a.Placeholder,{label:"Thermal group",instructions:"Display multiple IR recordings taken by IR camera TIMI Edu.",icon:(0,c.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",viewBox:"0 0 512 512",children:(0,c.jsx)("g",{children:(0,c.jsxs)("g",{id:"Vrstva_1",children:[(0,c.jsx)("path",{d:"M327.6,240c-5.4-4.7-13.6-7.1-24.6-7.1h-51.9v60.8h52c10.9,0,19-2.4,24.6-7.2s8.2-12.7,8.2-23.6-2.8-18.1-8.3-22.8Z"}),(0,c.jsx)("path",{d:"M252.4,0L18.9,90.7h-.6v421.3h466.9V90.7h.6L252.4,0ZM161.8,411.9h-47.5v-216h47.5v216ZM342.1,411.9c-2.8-7.9-4.5-16.2-4.9-24.6-.6-9.5-1.5-18.4-2.7-27.2-1.6-11.3-5-19.5-10.3-24.8s-13.8-7.9-25.7-7.9h-47.5v84.4h-47.5v-215.9h116.4c8.9-.1,17.8,1.5,26.2,4.7,7.4,2.9,14.2,7.3,19.9,12.8,5.5,5.4,9.8,11.8,12.7,18.9,3,7.3,4.5,15.2,4.4,23.1.3,11.5-2.4,22.9-7.9,33-6,9.9-15.3,17.3-26.2,21.2v.6c5.3,1.3,10.3,3.9,14.5,7.4,3.8,3.3,7,7.3,9.4,11.8,2.5,4.7,4.3,9.7,5.3,15,1.1,5.4,1.9,10.9,2.3,16.3.2,3.4.4,7.5.6,12.1s.6,9.2,1.1,14.2c.5,4.6,1.3,9.2,2.4,13.7.9,4,2.6,7.7,5,11.1h-47.6Z"})]})})}),children:(0,c.jsx)(l.MediaUpload,{allowedTypes:["application/octet-stream"],multiple:!0,onSelect:e=>{if(Array.isArray(e)){const s=e.map((e=>e.url));N.syncUrls(s)}},render:({open:e})=>(0,c.jsx)(a.Button,{onClick:()=>{D(),e()},variant:"primary",children:y?"Change file":"Upload or select a LRC file"})})})})]})},icon:{src:(0,c.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",viewBox:"0 0 512 512",children:(0,c.jsx)("g",{children:(0,c.jsxs)("g",{id:"Layer one",children:[(0,c.jsx)("path",{d:"M327.6,240c-5.4-4.7-13.6-7.1-24.6-7.1h-51.9v60.8h52c10.9,0,19-2.4,24.6-7.2s8.2-12.7,8.2-23.6-2.8-18.1-8.3-22.8Z"}),(0,c.jsx)("path",{d:"M252.4,0L18.9,90.7h-.6v421.3h466.9V90.7h.6L252.4,0ZM161.8,411.9h-47.5v-216h47.5v216ZM342.1,411.9c-2.8-7.9-4.5-16.2-4.9-24.6-.6-9.5-1.5-18.4-2.7-27.2-1.6-11.3-5-19.5-10.3-24.8s-13.8-7.9-25.7-7.9h-47.5v84.4h-47.5v-215.9h116.4c8.9-.1,17.8,1.5,26.2,4.7,7.4,2.9,14.2,7.3,19.9,12.8,5.5,5.4,9.8,11.8,12.7,18.9,3,7.3,4.5,15.2,4.4,23.1.3,11.5-2.4,22.9-7.9,33-6,9.9-15.3,17.3-26.2,21.2v.6c5.3,1.3,10.3,3.9,14.5,7.4,3.8,3.3,7,7.3,9.4,11.8,2.5,4.7,4.3,9.7,5.3,15,1.1,5.4,1.9,10.9,2.3,16.3.2,3.4.4,7.5.6,12.1s.6,9.2,1.1,14.2c.5,4.6,1.3,9.2,2.4,13.7.9,4,2.6,7.7,5,11.1h-47.6Z"})]})})})}})}},t={};function l(e){var a=t[e];if(void 0!==a)return a.exports;var n=t[e]={exports:{}};return s[e](n,n.exports,l),n.exports}l.m=s,e=[],l.O=(s,t,a,n)=>{if(!t){var i=1/0;for(d=0;d<e.length;d++){t=e[d][0],a=e[d][1],n=e[d][2];for(var o=!0,r=0;r<t.length;r++)(!1&n||i>=n)&&Object.keys(l.O).every((e=>l.O[e](t[r])))?t.splice(r--,1):(o=!1,n<i&&(i=n));if(o){e.splice(d--,1);var c=a();void 0!==c&&(s=c)}}return s}n=n||0;for(var d=e.length;d>0&&e[d-1][2]>n;d--)e[d]=e[d-1];e[d]=[t,a,n]},l.o=(e,s)=>Object.prototype.hasOwnProperty.call(e,s),(()=>{var e={557:0,985:0};l.O.j=s=>0===e[s];var s=(s,t)=>{var a,n,i=t[0],o=t[1],r=t[2],c=0;if(i.some((s=>0!==e[s]))){for(a in o)l.o(o,a)&&(l.m[a]=o[a]);if(r)var d=r(l)}for(s&&s(t);c<i.length;c++)n=i[c],l.o(e,n)&&e[n]&&e[n][0](),e[n]=0;return l.O(d)},t=self.webpackChunk_labir_wordpress=self.webpackChunk_labir_wordpress||[];t.forEach(s.bind(null,0)),t.push=s.bind(null,t.push.bind(t))})();var a=l.O(void 0,[985],(()=>l(41)));a=l.O(a)})();